--CODE WITH "~[]"s ARE SPECIFIC TO BEING WITHIN POWERSCHOOL. 
--THEY WILL NEED TO BE COMMENTED OUT IF YOU ARE TRYING TO RUN IT IN SQLDEVELOPER


SELECT DISTINCT 
 SCH.NAME 
, S.STUDENT_NUMBER
, S.STATE_STUDENTNUMBER
, INITCAP(S.LASTFIRST)
, S.GRADE_LEVEL 
FROM STUDENTS S
LEFT OUTER JOIN SCHOOLS SCH ON SCH.SCHOOL_NUMBER = S.SCHOOLID
LEFT OUTER JOIN S_IN_STU_X ON S_IN_STU_X.STUDENTSDCID = S.DCID
WHERE S.ENROLL_STATUS = 0
AND (S_IN_STU_X.PRIMARYSCHOOLENROLLMENT IS NULL OR S_IN_STU_X.PRIMARYSCHOOLENROLLMENT <> 'N')
~[IF.IS.A.SCHOOL] AND S.SCHOOLID = ~(CURSCHOOLID) [/IF]
ORDER BY  SCH.NAME, S.GRADE_LEVEL ,  INITCAP(S.LASTFIRST)
